services:
  opencode-cli:
    image: opencode-hybrid:latest
    container_name: opencode-cli
    ports:
      - "3000:3000"
    volumes:
      - /c/can/nop:/app/workspace:rw
      - /c/can/opencode/nop-entropy-config.json:/app/.opencode/config.json:ro
      - /c/can/opencode/share:/root/.local/share:rw
    working_dir: /app/workspace/nop-entropy
    restart: unless-stopped
    stdin_open: true
    tty: true
    environment:
      - NODE_ENV=production
      - OPENCODE_HOME=/app
      - OPENCODE_CONFIG=/app/.opencode/config.json
      - OPENCODE_WORKSPACE=/app/workspace
      - NPM_CONFIG_REGISTRY=https://registry.npmmirror.com
    command: ["/app/start-services.sh"]
